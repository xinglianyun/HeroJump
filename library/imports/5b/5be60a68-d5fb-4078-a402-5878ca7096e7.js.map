{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\enemy/assets\\Script\\enemy\\DartEnemy.js"],"names":["Global","require","dartNodes","cc","Class","extends","Component","properties","type","default","String","emitDartTime","Float","_startSide","Integer","_overScreenX","addChildDartNode","dartNode","parent","node","push","onLoad","_game","find","_gameMainScene","getComponent","_totalOffsetY","_stopMove","_targetWorldPos","Vec2","_isEmitDart","setRealListener","start","update","dt","gameMainSceneSpeed","getRunSpeed","offsetY","y","Math","abs","director","getWinSize","height","emitDartNode","setStartSide","startSide","setGameManager","gameManager","_gameManager","setTargetWorldPos","worldPos","beVictory","stopAllActions","beKilled","collectEnemy","i","moveToHeroPos","convertToNodeSpace","x","moveAction","moveTo","callfunc","callFunc","target","sequence","runAction","length"],"mappings":"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","file":"DartEnemy.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\enemy","sourcesContent":["\r\nvar Global = require(\"Global\")\r\nvar dartNodes = [];\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        type : {\r\n            default : \"dartenemy\",\r\n            type : cc.String\r\n        },\r\n        // emit the dart when the dart enemy go throw the screen\r\n        emitDartTime : {\r\n            default : 0.5,\r\n            type : cc.Float\r\n        },\r\n        _startSide : {\r\n            default : -1, \r\n            type : cc.Integer\r\n        },\r\n        _overScreenX : {\r\n            default : -100.0,\r\n            type : cc.Float\r\n        },\r\n    },\r\n\r\n\r\n    //logic\r\n    addChildDartNode : function(dartNode){\r\n        dartNode.parent = this.node\r\n        dartNodes.push(dartNode)\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this._game = cc.find(\"Game\")\r\n        this._gameMainScene = this._game.getComponent(\"GameMainScene\")\r\n        this._totalOffsetY = 0.0\r\n        this._startSide = -1\r\n        this._stopMove = false\r\n        this._targetWorldPos = cc.Vec2(0, 0)\r\n        this._isEmitDart = false\r\n        this.node.getComponent(\"Enemy\").setRealListener(this)\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    update (dt) {\r\n        var gameMainSceneSpeed = this._gameMainScene.getRunSpeed()\r\n        var offsetY = gameMainSceneSpeed * dt\r\n        this.node.y -= offsetY\r\n        this._totalOffsetY += offsetY\r\n\r\n        if(Math.abs(this._totalOffsetY) >= cc.director.getWinSize().height * this.emitDartTime){\r\n            // emit the DartNode\r\n            this.emitDartNode()\r\n        }\r\n    },\r\n\r\n    // logic\r\n    setStartSide : function(startSide){\r\n        this._startSide = startSide\r\n    },\r\n\r\n    setGameManager : function(gameManager){\r\n        this._gameManager = gameManager\r\n    },\r\n\r\n    setTargetWorldPos : function(worldPos){\r\n        this._targetWorldPos = worldPos\r\n    },\r\n\r\n    beVictory : function(){\r\n        this.node.stopAllActions()\r\n    },\r\n\r\n    beKilled : function(){\r\n        this.node.stopAllActions()\r\n        this._gameManager.collectEnemy(this.node, this.type)\r\n    },\r\n\r\n    emitDartNode : function(){\r\n        \r\n        for(let i = 0; i < dartNodes.length; ++i){\r\n            //dartNodes[i].getComponent(\"DartNode\").runToTarget(this._targetWorldPos, i, dartNodes.length)\r\n            if(i === 0){\r\n                var moveToHeroPos = this.node.convertToNodeSpace(this._targetWorldPos)\r\n                moveToHeroPos.x += -this._startSide*this._overScreenX\r\n                moveToHeroPos.y -= (this._overScreenX * Math.abs(this.node.y - moveToHeroPos.y)) / (Math.abs(this.node.x - moveToHeroPos.x))\r\n                var moveAction = cc.moveTo(cc.director.getWinSize().height * (1- this.emitDartTime) / this._gameMainScene.getRunSpeed(), moveToHeroPos)\r\n    \r\n                var callfunc = cc.callFunc(function(target){\r\n                    this._gameManager.collectEnemy(dartNodes[i], \"dartnode\")\r\n                }, this)\r\n                var sequence = cc.sequence(moveAction, callfunc)\r\n                dartNodes[i].parent = this.node.parent\r\n                dartNodes[i].runAction(sequence)\r\n            }\r\n        }\r\n    }\r\n});\r\n"]}