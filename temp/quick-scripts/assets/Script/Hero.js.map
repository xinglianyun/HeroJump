{"version":3,"sources":["Hero.js"],"names":["HeroStatus","cc","Enum","dead","running","jump","fly","Class","extends","Component","properties","colliderProxy","default","type","require","_circlePropNode","node","onLoad","Global","hero","start","_status","_leftOrRight","setRealListener","_allProps","circleprop","setLeftOrRight","leftOrRight","getLeftOrRight","run","addProp","propNode","getComponent","beOnHero","propEnemyType","getPropEnemyType","enemyType","addCircleProp","parent","deleteCircleProp","beCollected","onCollisionEnter","other","self","console","log","group","game","groupList","groupIndex","beKilled","gameMainScene","gameOver","beVictory"],"mappings":"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","file":"Hero.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["// 英雄状态\r\nvar HeroStatus = cc.Enum({\r\n    dead : -1,\r\n    running : -1,\r\n    jump : -1,\r\n    fly : -1,\r\n})\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // 碰撞代理组件\r\n        colliderProxy : {\r\n            default : null,\r\n            type : require(\"HeroColliderProxy\")\r\n        },\r\n        // 圆圈道具指针\r\n        _circlePropNode : {\r\n            default : null,\r\n            type : cc.node\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        Global.hero = this\r\n    },\r\n\r\n    start () {\r\n        this._status = HeroStatus.running\r\n        this._leftOrRight = -1\r\n        this._circlePropNode = null\r\n        this.colliderProxy.setRealListener(this)\r\n        this._allProps = {\r\n            circleprop : 0\r\n        }\r\n    },\r\n\r\n    // update (dt) {},\r\n\r\n    //************************************start logic*************************************************//\r\n    /**\r\n     * desc: left(-1) or right(1)\r\n     */\r\n    setLeftOrRight : function(leftOrRight){\r\n        this._leftOrRight = leftOrRight\r\n    },\r\n\r\n    /**\r\n     * desc: return left or right\r\n     */\r\n    getLeftOrRight : function(){\r\n        return this._leftOrRight\r\n    },\r\n\r\n    run : function(){\r\n        this._status = HeroStatus.running\r\n    },\r\n\r\n    jump : function(){\r\n        this._status = HeroStatus.jump\r\n    },\r\n\r\n    fly : function(){\r\n        this._status = HeroStatus.fly\r\n    },\r\n\r\n    dead : function(){\r\n        this._status = HeroStatus.dead\r\n    },\r\n\r\n\r\n    /**\r\n     * desc: add the prop\r\n     */\r\n    addProp : function(propNode){\r\n        propNode.getComponent(\"Prop\").beOnHero()\r\n        var propEnemyType = propNode.getComponent(\"Prop\").getPropEnemyType()\r\n        switch(propEnemyType){\r\n            case Global.enemyType.circleprop:\r\n                this.addCircleProp(propNode)\r\n                break\r\n        }\r\n    },\r\n\r\n    /**\r\n     * desc: add the circle prop\r\n     */\r\n    addCircleProp(propNode){\r\n        this._allProps.circleprop += 1\r\n        propNode.parent = this.node\r\n        if(!this._circlePropNode){\r\n            this._circlePropNode = propNode\r\n        }\r\n    },\r\n    /**\r\n     * desc: delete one circle prop\r\n     */\r\n    deleteCircleProp(){\r\n        this._allProps.circleprop -= 1\r\n        if(this._allProps.circleprop <= 0){\r\n            this._allProps.circleprop = 0\r\n            this._circlePropNode.getComponent(\"Prop\").beCollected()\r\n            this._circlePropNode = null\r\n        }\r\n    },\r\n\r\n    /**\r\n     * desc: 当碰撞产生的时候调用\r\n     * @param  {Collider} other 产生碰撞的另一个碰撞组件\r\n     * @param  {Collider} self  产生碰撞的自身的碰撞组件\r\n     */\r\n    onCollisionEnter: function (other, self) {\r\n        console.log('on collision enter')\r\n        \r\n        if(this._status !== HeroStatus.dead){\r\n            var group = cc.game.groupList[other.node.groupIndex]\r\n            if(group === \"enemy\"){\r\n                if(this._status === HeroStatus.running){\r\n                    if(this._allProps.circleprop > 0){\r\n                        this.deleteCircleProp()\r\n                        other.node.getComponent(\"Enemy\").beKilled()\r\n                    }else{\r\n                        // dead, game oveer\r\n                        this.dead()\r\n                        Global.gameMainScene.gameOver()\r\n                        other.node.getComponent(\"Enemy\").beVictory()\r\n                    }\r\n                }else{\r\n                    other.node.getComponent(\"Enemy\").beKilled()\r\n                }\r\n            }else if(group === \"prop\") {\r\n                this.addProp(other.node)\r\n            }\r\n        }\r\n    },\r\n    //************************************end logic*************************************************//\r\n});\r\n"]}