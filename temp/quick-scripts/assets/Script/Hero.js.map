{"version":3,"sources":["Hero.js"],"names":["HeroStatus","cc","Enum","dead","running","jump","fly","Class","extends","Component","properties","colliderProxy","default","type","require","onLoad","Global","hero","start","_status","_leftOrRight","setRealListener","_allProps","circleprop","count","circlePropNode","setLeftOrRight","leftOrRight","getLeftOrRight","run","addProp","propNode","getComponent","beOnHero","propEnemyType","getPropEnemyType","enemyType","addCircleProp","parent","node","deleteCircleProp","beCollected","onCollisionEnter","other","self","console","log","group","game","groupList","groupIndex","beKilled","gameMainScene","gameOver","beVictory"],"mappings":"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","file":"Hero.js","sourceRoot":"../../../../assets/Script","sourcesContent":["// 英雄状态\nvar HeroStatus = cc.Enum({\n    dead : -1,\n    running : -1,\n    jump : -1,\n    fly : -1,\n})\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // 碰撞代理组件\n        colliderProxy : {\n            default : null,\n            type : require(\"HeroColliderProxy\")\n        },\n        \n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        Global.hero = this\n    },\n\n    start () {\n        this._status = HeroStatus.running\n        this._leftOrRight = -1\n        this.colliderProxy.setRealListener(this)\n        this._allProps = {\n            circleprop : {\n                count : 0,\n                circlePropNode : null\n            }\n        }\n    },\n\n    // update (dt) {},\n\n    //************************************start logic*************************************************//\n    /**\n     * desc: left(-1) or right(1)\n     */\n    setLeftOrRight : function(leftOrRight){\n        this._leftOrRight = leftOrRight\n    },\n\n    /**\n     * desc: return left or right\n     */\n    getLeftOrRight : function(){\n        return this._leftOrRight\n    },\n\n    run : function(){\n        this._status = HeroStatus.running\n    },\n\n    jump : function(){\n        this._status = HeroStatus.jump\n    },\n\n    fly : function(){\n        this._status = HeroStatus.fly\n    },\n\n    dead : function(){\n        this._status = HeroStatus.dead\n    },\n\n\n    /**\n     * desc: add the prop\n     */\n    addProp : function(propNode){\n        propNode.getComponent(\"Prop\").beOnHero()\n        var propEnemyType = propNode.getComponent(\"Prop\").getPropEnemyType()\n        switch(propEnemyType){\n            case Global.enemyType.circleprop:\n                this.addCircleProp(propNode)\n                break\n        }\n    },\n\n    /**\n     * desc: add the circle prop\n     */\n    addCircleProp(propNode){\n        this._allProps.circleprop.count += 1\n        propNode.parent = this.node\n        if(!this._allProps.circleprop.circlePropNode){\n            this._allProps.circleprop.circlePropNode= propNode\n        }\n    },\n    /**\n     * desc: delete one circle prop\n     */\n    deleteCircleProp(){\n        this._allProps.circleprop.count -= 1\n        if(this._allProps.circleprop.count <= 0){\n            this._allProps.circleprop.count = 0\n            this._allProps.circleprop.circlePropNode.getComponent(\"Prop\").beCollected()\n            this._allProps.circleprop.circlePropNode = null\n        }\n    },\n\n    /**\n     * desc: 当碰撞产生的时候调用\n     * @param  {Collider} other 产生碰撞的另一个碰撞组件\n     * @param  {Collider} self  产生碰撞的自身的碰撞组件\n     */\n    onCollisionEnter: function (other, self) {\n        console.log('on collision enter')\n        \n        if(this._status !== HeroStatus.dead){\n            var group = cc.game.groupList[other.node.groupIndex]\n            if(group === \"enemy\"){\n                if(this._status === HeroStatus.running){\n                    if(this._allProps.circleprop > 0){\n                        this.deleteCircleProp()\n                        other.node.getComponent(\"Enemy\").beKilled()\n                    }else{\n                        // dead, game oveer\n                        this.dead()\n                        Global.gameMainScene.gameOver()\n                        other.node.getComponent(\"Enemy\").beVictory()\n                    }\n                }else{\n                    other.node.getComponent(\"Enemy\").beKilled()\n                }\n            }else if(group === \"prop\") {\n                this.addProp(other.node)\n            }\n        }\n    },\n    //************************************end logic*************************************************//\n});\n"]}